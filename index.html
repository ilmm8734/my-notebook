<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ú–æ–π –ë–ª–æ–∫–Ω–æ—Ç</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

body {
    font-family: 'Poppins', sans-serif;
    background-color: #f9f9f9;
    margin: 0;
    padding: 0;
    transition: background 0.3s, color 0.3s;
}

body.dark {
    background-color: #121212;
    color: #e0e0e0;
}

header {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    align-items: center;
    padding: 15px 20px;
    background-color: white;
    border-bottom: 1px solid #ff4d4d;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    transition: background 0.3s, border-color 0.3s;
}

body.dark header {
    background-color: #1e1e1e;
    border-color: #ff6b6b;
}

h1 { color: #ff4d4d; margin: 0; font-weight: 600; }

button {
    background: none;
    border: 1px solid #ff4d4d;
    color: #ff4d4d;
    padding: 6px 12px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s ease;
}

body.dark button { border-color: #ff6b6b; color: #ff6b6b; }

button:hover { background-color: #ffe6e6; transform: scale(1.05); }
body.dark button:hover { background-color: #330000; }

input#search {
    padding: 6px 10px;
    border-radius: 6px;
    border: 1px solid #ff4d4d;
    margin-right: 10px;
    transition: all 0.3s;
}

body.dark input#search { border-color: #ff6b6b; background-color: #1e1e1e; color: #e0e0e0; }

.notes-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 15px;
    padding: 20px;
}

.note {
    background: white;
    border: 1px solid #ff4d4d;
    border-radius: 8px;
    padding: 15px;
    position: relative;
    box-shadow: 0 3px 10px rgba(0,0,0,0.05);
    cursor: pointer;
    overflow: hidden;
    transition: all 0.3s ease, transform 0.3s ease, opacity 0.3s ease;
}

body.dark .note { background: #1e1e1e; border-color: #ff6b6b; color: #e0e0e0; }

.note h3 { margin:0; font-weight:600; color:#ff4d4d; }
body.dark .note h3 { color:#ff6b6b; }

.note p { margin:5px 0 0 0; color:inherit; }

.fullscreen {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: white;
    border: 1px solid #ff4d4d;
    z-index: 1000;
    padding: 20px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    transition: background 0.3s, color 0.3s;
}

body.dark .fullscreen { background: #1e1e1e; border-color: #ff6b6b; color:#e0e0e0; }

.fullscreen h3, .fullscreen p { outline:none; }
.fullscreen h3 { font-size:1.8em; color:#ff4d4d; }
body.dark .fullscreen h3 { color:#ff6b6b; }
.fullscreen p { flex-grow:1; margin-top:10px; line-height:1.4em; white-space: pre-wrap; }

.close-btn { align-self:flex-end; margin-bottom:10px; cursor:pointer; border:none; background:none; font-size:20px; color:#ff4d4d; }
body.dark .close-btn { color:#ff6b6b; }

#notification {
    position: fixed;
    bottom: 20px;
    left:50%;
    transform: translateX(-50%);
    background: #ff4d4d;
    color:white;
    padding:8px 15px;
    border-radius:6px;
    opacity:0;
    pointer-events:none;
    transition: opacity 0.5s;
}

body.dark #notification { background:#ff6b6b; }

@media (max-width:500px) {
    .notes-container { grid-template-columns:1fr; padding:10px; }
    header { flex-direction: column; align-items: flex-start; gap: 10px; }
}
</style>
</head>
<body>

<header>
    <h1>–ú–æ–π –ë–ª–æ–∫–Ω–æ—Ç</h1>
    <div class="header-controls">
        <input type="text" id="search" placeholder="–ü–æ–∏—Å–∫ –∑–∞–º–µ—Ç–æ–∫..." oninput="renderNotes()">
        <button onclick="addNote()">Ôºã –ù–æ–≤–∞—è –∑–∞–º–µ—Ç–∫–∞</button>
        <button onclick="clearAllNotes()">üóë –û—á–∏—Å—Ç–∏—Ç—å –±–ª–æ–∫–Ω–æ—Ç</button>
        <button onclick="toggleDarkMode()">üåì –¢–µ–º–∞</button>
    </div>
</header>

<div class="notes-container" id="notesContainer"></div>
<div id="fullscreenContainer" style="display:none;"></div>
<div id="notification"></div>

<script>
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
let notes = JSON.parse(localStorage.getItem('notes')) || [];
let darkMode = JSON.parse(localStorage.getItem('darkMode')) || false;
if(darkMode) document.body.classList.add('dark');
let saveTimeout = null;

// –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
function showNotification(text) {
    const notif = document.getElementById('notification');
    notif.innerText = text;
    notif.style.opacity = 1;
    setTimeout(()=>{notif.style.opacity=0}, 1500);
}

// –†–µ–Ω–¥–µ—Ä –∑–∞–º–µ—Ç–æ–∫
function renderNotes() {
    const container = document.getElementById('notesContainer');
    container.innerHTML='';
    const query = document.getElementById('search').value.toLowerCase();
    notes.forEach((note,index)=>{
        if(note.title.toLowerCase().includes(query) || note.text.toLowerCase().includes(query)) {
            const noteElem=document.createElement('div');
            noteElem.className='note';
            noteElem.style.opacity=0;
            noteElem.style.transform='scale(0.95)';
            noteElem.innerHTML=`<h3>${note.title}</h3><p>${note.text.substring(0,50)}...</p>`;
            noteElem.onclick=()=>openFullscreen(index);
            container.appendChild(noteElem);
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
            setTimeout(()=>{noteElem.style.opacity=1; noteElem.style.transform='scale(1)';},50);
        }
    });
    localStorage.setItem('notes',JSON.stringify(notes));
}

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–º–µ—Ç–∫–∏
function addNote() {
    notes.push({title:'–ù–æ–≤–∞—è –∑–∞–º–µ—Ç–∫–∞',text:'–¢–µ–∫—Å—Ç...'});
    renderNotes();
    showNotification('–ó–∞–º–µ—Ç–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞');
}

// –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –∑–∞–º–µ—Ç–æ–∫
function clearAllNotes(){
    if(confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –∑–∞–º–µ—Ç–∫–∏?')){
        notes=[];
        renderNotes();
        showNotification('–í—Å–µ –∑–∞–º–µ—Ç–∫–∏ —É–¥–∞–ª–µ–Ω—ã');
    }
}

// –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
function openFullscreen(index){
    const container=document.getElementById('fullscreenContainer');
    container.style.display='flex';
    container.className='fullscreen';
    container.innerHTML=`
        <button class="close-btn" onclick="closeFullscreen()">‚úñ –ó–∞–∫—Ä—ã—Ç—å</button>
        <h3 contenteditable="true" id="fsTitle">${notes[index].title}</h3>
        <p contenteditable="true" id="fsText">${notes[index].text}</p>
        <button onclick="downloadNote(${index})">üíæ –°–∫–∞—á–∞—Ç—å</button>
    `;
    const fsTitle=document.getElementById('fsTitle');
    const fsText=document.getElementById('fsText');

    function save() {
        notes[index].title=fsTitle.innerText;
        notes[index].text=fsText.innerText;
        localStorage.setItem('notes',JSON.stringify(notes));
        renderNotes();
        showNotification('–ó–∞–º–µ—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞');
    }

    fsTitle.oninput=fsText.oninput=(e)=>{
        if(saveTimeout) clearTimeout(saveTimeout);
        saveTimeout=setTimeout(save, 1000); // –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 1 —Å–µ–∫
    };
}

// –ó–∞–∫—Ä—ã—Ç—å –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
function closeFullscreen(){
    document.getElementById('fullscreenContainer').style.display='none';
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—è –∑–∞–º–µ—Ç–∫–∏
function updateNoteField(index,field,value){
    notes[index][field]=value;
    localStorage.setItem('notes',JSON.stringify(notes));
    renderNotes();
}

// –¢—ë–º–Ω–∞—è —Ç–µ–º–∞
function toggleDarkMode(){
    document.body.classList.toggle('dark');
    darkMode=document.body.classList.contains('dark');
    localStorage.setItem('darkMode',JSON.stringify(darkMode));
}

// –°–∫–∞—á–∞—Ç—å –∑–∞–º–µ—Ç–∫—É
function downloadNote(index){
    const element=document.createElement('a');
    const file=new Blob([notes[index].title+'\n\n'+notes[index].text],{type:'text/plain'});
    element.href=URL.createObjectURL(file);
    element.download=`${notes[index].title}.txt`;
    document.body.appendChild(element);
    element.click();
    document.body.removeChild(element);
}

renderNotes();
</script>
</body>
</html>
